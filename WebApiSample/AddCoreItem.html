<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="utf-8" />
    <script src="scripts/jquery-2.2.3.js"></script>
    <link href="Content/bootstrap.css" rel="stylesheet" />
    <script>

        function myFunction(arr) {
            debugger;
            var out = "";
            var i;
            for (i = 0; i < arr.length; i++) {
                out += '<a href="' + arr[i].url + '">' +
                arr[i].display + '</a><br>';
            }
            document.getElementById("id01").innerHTML = out;
        }


        $(document).ready(function () {

            $('#mainDiv').on('click', '.close', function () {
                $('#CoreItemMessage').empty().removeClass();
            });

            $("#buttonSubmit").on('click', function () {

                var uri = "api/CoreItems";

                var coreItem;
                coreItem = {
                    "ItemId": 4,
                    "ItemNumber": "",
                    "VendorCode": "",
                    "ItemDescription": "Gr. 1: Words Their Way Level A Student Notebook (Consumable)",
                    "Price": 8.35,
                    "DeliveryCharge": 0,
                    "CostPrice": 8.35,
                    "Grade": "1",
                    "CreatedBy": "SystemAdmin",
                    "CreatedDate": "2016-01-21T11:25:17.043",
                    "UpdatedBy": "SystemAdmin",
                    "UpdatedDate": "2016-01-21T11:25:17.043"
                };

                $.ajax({
                    url: 'http://localhost:58407/api/CoreItems',
                    type: 'POST',
                    dataType: 'json',
                    data: coreItem,
                    async: false
                })

                .done(function (data) {
                    //debugger;
                    $('#CoreItemMessage').addClass('alert alert-success').html("Item added successfully.")
                        .append("<a href='#' class='close' data-dismiss='alert' aria-label='close'>&times;</a>");
                })
                .error(function (jqXHR, textStatus, errorThrown) {
                    // jqXHR - XMLHttpRequest object
                    // textStatus - Possible values for the second argument (besides null) are "timeout", "error", "abort", and "parsererror". 
                    // errorThrown - When an HTTP error occurs, errorThrown receives the textual portion of the HTTP status, such as "Not Found" or "Internal Server Error."

                    //debugger;
                    var response = null;
                    var errors = [];
                    var errorsString = "";
                    if (jqXHR.status == 400) {
                        try {
                            errors = JSON.parse(jqXHR.responseText);

                            for (var i = 0; i < errors.length; i++) {
                                errorsString = errorsString + '<p>' + errors[i] + '</p>'
                            }
                        }
                        catch (e) { //this is not sending us a ModelState, else we would get a good responseText JSON to parse)
                        }
                    }

                    ////DISPLAY THE LIST OF ERROR MESSAGES
                    if (errorsString != "") {
                        $('#CoreItemMessage').addClass('alert alert-danger').html("<div class='text-right'><a href='#' class='close' data-dismiss='alert' aria-label='close'>&times;</a></div><div>" + errorsString + "</div>");

                        //$('#CoreItemMessage').addClass('alert alert-danger').html(errorsString)
                        //    .append("<a href='#' class='close' data-dismiss='alert' aria-label='close'>&times;</a>");
                    }
                });

                return false;
            });
        });
    </script>
</head>
<body>
    <div class="container" id="mainDiv" style="margin-top:100px;">
        <div class="row">
            <div class="col-md-offset-1 col-md-10 col-md-offset-1">


                <div class="panel panel-info">
                    <div class="panel-heading"><h4><i class="glyphicon glyphicon-pencil"></i> Add Core Item</h4></div>
                    <div class="panel-body">
                        <form role="form">
                            <div class="row">
                                <section class="col-md-3">
                                    <label for="inputItemNumber">Item Number</label>
                                    <input type="text" class="form-control" maxlength="9" id="inputItemNumber" placeholder="enter item number" />
                                </section>
                                <section class="col-md-3">
                                    <label for="inputVendorCode">Vendor Code</label>
                                    <input type="text" class="form-control" maxlength="9" id="inputVendorCode" placeholder="enter vendor code" />
                                </section>
                            </div>
                            <div class="row">
                                &nbsp;
                            </div>
                            <div class="row">
                                <section class="col-md-6">
                                    <label for="inputDescription">Description</label>
                                    <input type="text" class="form-control" maxlength="9" id="inputDescription" placeholder="enter item description" />
                                </section>
                            </div>
                            <div class="row">
                                &nbsp;
                            </div><div class="row">

                                <section class="col-md-3">
                                    <label for="inputDescription">Price</label>
                                    <input type="text" class="form-control" maxlength="9" id="inputDescription" placeholder="enter item description" />
                                </section>
                                <section class="col-md-3">
                                    <label for="inputDescription">Delivery Charge</label>
                                    <input type="text" class="form-control" maxlength="9" id="inputDescription" placeholder="enter item description" />
                                </section>
                            </div>
                            <div class="row">
                                &nbsp;
                            </div>
                            <div class="row">
                                <section class="col-md-3">
                                    <label>Grade</label>
                                    <select class="form-control" id="selectGrade">
                                        <option value="PreK">Grade PreK</option>
                                        <option value="K">Grade K</option>
                                        <option value="1">Grade 01</option>
                                        <option value="2">Grade 02</option>
                                        <option value="3">Grade 03</option>
                                        <option value="4">Grade 04</option>
                                        <option value="5">Grade 05</option>
                                        <option value="6">Grade 06</option>
                                        <option value="7">Grade 07</option>
                                        <option value="8">Grade 08</option>
                                        <option value="9">Grade 09</option>
                                        <option value="10">Grade 10</option>
                                        <option value="11">Grade 11</option>
                                        <option value="12">Grade 12</option>
                                    </select>
                                </section>
                            </div>
                            <div class="row">
                                &nbsp;
                            </div>
                            <div class="row">
                                <section class="col-md-3">
                                    <button type="submit" id="buttonSubmit" class="btn btn-primary">Submit</button>
                                </section>
                            </div>
                            <div class="row" style="margin-top:10px;">
                                <div class="col-sm-12">
                                    <div id="CoreItemMessage">

                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
